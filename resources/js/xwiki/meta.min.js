'use strict';define(["jquery","xwiki-entityReference","xwiki-events-bridge"],function(f,c){class g{constructor(){this.init()}init(){const a=document.documentElement;if(a.dataset.xwikiReference){this.documentReference=c.Model.resolve(a.dataset.xwikiReference,c.EntityType.DOCUMENT);var d=this.documentReference.extractReference(c.EntityType.WIKI);const b=this.documentReference.extractReference(c.EntityType.SPACE);this.document=c.Model.serialize(this.documentReference.relativeTo(d));this.wiki=d.getName();
this.space=c.Model.serialize(b.relativeTo(d));this.page=this.documentReference.getName();this.version=a.dataset.xwikiVersion;this.restURL=a.dataset.xwikiRestUrl;this.form_token=a.dataset.xwikiFormToken;this.userReference=(d=a.dataset.xwikiUserReference)?c.Model.resolve(d,c.EntityType.DOCUMENT):null;this.isNew="true"===a.dataset.xwikiIsnew;this.locale=a.dataset.xwikiLocale}else{const b="document wiki space page version restURL form_token".split(" ");document.querySelectorAll("meta").forEach(e=>{b.includes(e.name)&&
(this[e.name]=e.content)})}}setVersion(a){this.version=a;f(document).trigger("xwiki:document:changeVersion",{version:this.version,documentReference:this.documentReference})}async refreshVersion(a){const d=this.restURL+"?media=json&timestamp="+(new Date).getTime();try{const b=await fetch(d);if(!b.ok)if(404===b.status&&"function"===typeof a)a(b);else throw Error(`Response status: ${b.status}`);const e=await b.json();this.setVersion(e.version)}catch(b){console.error("Error while refreshing the version from URL "+
d,b)}}}return new g});
//# sourceMappingURL=meta.min.js.map
