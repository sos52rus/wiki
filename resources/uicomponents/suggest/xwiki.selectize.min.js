'use strict';define("xwiki-selectize-messages",{prefix:"web.uicomponents.suggest.",keys:["selectTypedText"]});
define("xwiki-selectize",["jquery","selectize","xwiki-l10n!xwiki-selectize-messages","xwiki-events-bridge"],function(d,g,l){var f=function(a){var b=d('<div class="xwiki-selectize-option" data-value=""><span class="xwiki-selectize-option-icon"></span><span class="xwiki-selectize-option-label"></span></div>');b.attr("data-value",a&&"object"===typeof a?a.value:a);var c=a&&a.icon;"object"===typeof c?(!c.iconSetType&&c.url?c.iconSetType="IMAGE":!c.iconSetType&&c.cssClass&&(c.iconSetType="FONT"),"IMAGE"===
c.iconSetType?(c=d('<img class="xwiki-selectize-option-icon" alt="" />').attr("src",c.url),b.find(".xwiki-selectize-option-icon").replaceWith(c)):"FONT"===c.iconSetType?b.find(".xwiki-selectize-option-icon").addClass(c.cssClass):b.find(".xwiki-selectize-option-icon").remove()):b.find(".xwiki-selectize-option-icon").remove();c=a&&a.url;"string"===typeof c&&(c=d('<a class="xwiki-selectize-option-label"></a>').attr("href",c),b.find(".xwiki-selectize-option-label").replaceWith(c));a=a&&"object"===typeof a?
a.label||a.value:a;b.find(".xwiki-selectize-option-label").text(a);return b},p={copyClassesToDropdown:!1,dropdownParent:"body",highlight:!1,labelField:"label",loadThrottle:500,onDropdownClose:function(a){a.removeClass("active")},onDropdownOpen:function(a){a.addClass("active")},persist:!0,preload:!0,render:{item:function(a){var b=f(a);a=a&&a.hint;"string"===typeof a&&""!==a&&b.attr("title",a);return b},option:function(a){var b=f(a);b.addClass("option");b.find(".xwiki-selectize-option-icon").wrap('<span class="xwiki-selectize-option-icon-wrapper"></span>');
a=a&&a.hint;"string"===typeof a&&""!==a&&b.append(d('<div class="xwiki-selectize-option-hint"></div>').text(a));return b},option_create:function(a,b){b=b(l.get("selectTypedText","__typedText__")).replace("__typedText__","<em></em>");b=d('<div class="create option"></div>').html(b);b.find("em").text(a.input);return b}},searchField:["value","label","hint"],onType:function(a){a="function"===typeof this.settings.load&&!this.loadedSearches.hasOwnProperty(a);this.get$("wrapper").toggleClass(this.settings.loadingClass,
a)},onInitialize:function(){this.get$("control").on("click","a.xwiki-selectize-option-label",function(a){a.preventDefault()})}},m=function(){var a=this.selectize,b=a.get$("wrapper");b.addClass(a.settings.loadingClass);a.loading++;a.items.reduce(function(c,e){return c.then(()=>q(a,e))},Promise.resolve()).finally(function(){a.loading=Math.max(a.loading-1,0);a.loading||b.removeClass(a.settings.loadingClass)})},q=function(a,b){return new Promise((c,e)=>{e="function"===typeof a.settings.loadSelected?a.settings.loadSelected:
a.settings.load;b&&"function"===typeof e?e.call(a,b,function(h){Array.isArray(h)&&h.forEach(function(k){var n=k[a.settings.valueField];a.options.hasOwnProperty(n)?a.updateOption(n,k):a.addOption(k)});c()}):c()})},t=function(){var a=this.selectize.positionDropdown;this.selectize.positionDropdown=function(){"body"===this.settings.dropdownParent&&a.call(this);"auto"===this.settings.dropdownWidth&&this.get$("dropdown").css({width:"","min-width":this.get$("control")[0].getBoundingClientRect().width})};
let b=this.selectize.onOptionSelect;this.selectize.onOptionSelect=function(...e){return b.apply(this,e)};let c=this.selectize.setActiveOption;this.selectize.setActiveOption=function(e,...h){this.liveRegion?.text(d(e).text());return c.call(this,e,...h)};this.selectize.liveRegion=d("<span>");this.selectize.liveRegion.attr("aria-live","assertive");this.selectize.liveRegion.addClass("sr-only");this.selectize.get$("input").after(this.selectize.liveRegion);r(this.selectize);this.selectize.settings.takeInputWidth&&
this.selectize.get$("control").width(d(this).data("initialWidth"));this.selectize.get$("control_input").attr("title",d(this).attr("title"));this.selectize.get$("control_input").attr("aria-label",d(this).attr("aria-label"))},r=function(a){var b=a.settings.dropdownAlignment;b||"body"===a.settings.dropdownParent||(b="left");b&&a.get$("dropdown").addClass("selectize-dropdown-"+b)};g.prototype.get$=function(a){return this["$"+a]};var u=function(a,b){var c=d.extend,e={};0===a.closest(".xform").length&&
(e.dropdownWidth="auto");return c.call(d,{},p,e,b,a.data("xwiki-selectize"))},v=function(a){var b=d(a).val();null===b&&d(a).attr("multiple")&&(b=[]);a=a.selectize.getValue();return Array.isArray(b)?Array.isArray(a)&&a.length===b.length&&a.every((c,e)=>c===b[e]):a===b},w=function(a){var b=a.selectize,c=d(a).val()||[];"string"===typeof c&&(c=c.split(b.settings.delimiter));b.clear(!0);c.forEach(e=>{b.options.hasOwnProperty(e)?b.addItem(e,!0):b.createItem(e,!1)});m.call(a)};d.fn.xwikiSelectize=function(a){this.each(function(){d(this).data("initialWidth",
d(this).width())});return this.not(".selectized, .selectize-control").on("initialize",t).on("change",function(b){v(this)?(b=d(this).closest(".xwiki-livetable-display-header-filter").closest(".xwiki-livetable").attr("id"))&&d(document).trigger("xwiki:livetable:"+b+":filtersChanged"):w(this)}).each(function(){var b=d(this).attr("id");d(this).removeAttr("id");d(this).selectize(u(d(this),a));b&&(this.selectize.get$("control_input").attr("id",b+"-selectized"),d("label").filter(function(){return d(this).attr("for")===
b}).attr("for",b+"-selectized"),d(this).attr("id",b))}).trigger("initialize").each(m)}});require(["jquery","xwiki-selectize","xwiki-events-bridge"],function(d){if(!d.fn.xwikiSelectize.initialized){d.fn.xwikiSelectize.initialized=!0;var g=function(l,f){d(f&&f.elements||document).find(".xwiki-selectize").xwikiSelectize()};d(document).on("xwiki:dom:updated",g);d(g)}});
//# sourceMappingURL=xwiki.selectize.min.js.map
