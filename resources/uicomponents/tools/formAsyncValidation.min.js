'use strict';define("xwiki-form-validation-async",["jquery"],function(l){const p=(a,b)=>{a.find('input[type="submit"], button[type="submit"]').first().prop("disabled",!b)},h=(a,b)=>{a=a.children("fieldset");const c=!a.prop("disabled");a.prop("disabled",!b);return c},q=function(a,b){return a.some(c=>0<=b.indexOf(c.__state))};document.addEventListener("submit",a=>{const b=l(a.target),c=a.submitter,d=Object.values(b.data("asyncValidations"));q(Object.values(d),["pending","rejected"])&&(a.preventDefault(),
a.stopPropagation(),h(b,!1),Promise.all(d).finally(()=>{h(b,!0)}).then(()=>{c?l(c).click():b.submit()}).catch(()=>{}))},!0);const r=function(a,b,c){let d,e;const f=new Promise((g,k)=>{d=()=>{clearTimeout(e);k()};e=setTimeout(()=>{const m=h(c,!0);Promise.resolve(a()).then(g,k);h(c,m)},b)});f.__abort=d;f.__state="pending";f.then(()=>{f.__state="fulfilled"}).catch(()=>{f.__state="rejected"});return f},t=function(a,b,c){return"function"===typeof a?(0<=b||(b=0),r(a,b,c)):r(()=>a,0,c)},u=({form:a,validation:b,
validationKey:c,delay:d})=>{const e=a.data("asyncValidations")||{};a.data("asyncValidations",e);const f=e[c],g=t(b,d,a);e[c]=g;f?.__abort();b=new Promise((k,m)=>{g.then(n=>{e[c]===g&&k(n)}).catch(n=>{e[c]===g&&m(n)})});b.catch(()=>{p(a,!1)});p(a,!q(Object.values(e),["rejected"]));return b};l.fn.validateAsync=function(a,b,c){let d=this.attr("id")||this.attr("name");if(!d)throw"The id and name attributes are both missing from the target form field.";2===arguments.length&&"string"===typeof b&&(c=b,b=
void 0);c&&(d=`${c}.${d}`);return u({form:this.closest("form"),validation:a,validationKey:d,delay:b})}});
//# sourceMappingURL=formAsyncValidation.min.js.map
