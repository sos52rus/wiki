'use strict';(function(){var sa=function(){var R="function"==typeof require&&require,X=function(V,m,G){m||=0;var k=X.resolve(V,m),n=X.m[m][k];if(!n&&R){if(n=R(k))return n}else if(n&&n.c&&(m=n.c,k=n.m,n=X.m[m][n.m],!n))throw Error('failed to require "'+k+'" from '+m);if(!n)throw Error('failed to require "'+V+'" from '+G);return n.exports||(n.exports={},n.call(n.exports,n,n.exports,X.relative(k,m))),n.exports};return X.resolve=function(V,m){var G=V+".js",k=V+"/index.js";return X.m[m][G]&&G?G:X.m[m][k]&&
k?k:V},X.relative=function(V,m){return function(G){if("."!=G.charAt(0))return X(G,m,V);var k=V.split("/");G=G.split("/");k.pop();for(var n=0;n<G.length;n++){var A=G[n];".."==A?k.pop():"."!=A&&k.push(A)}return X(k.join("/"),m,V)}},X}();sa.m=[];sa.m[0]={"json.sortify":{c:1,m:"dist/JSON.sortify.js"},"fast-diff":{c:2,m:"diff.js"},"Diff.js":function(R,X,V){var m=V("fast-diff"),G=function(k){var n=[],A=0,M=!0,P={offset:0,toInsert:"",toRemove:0,type:"Operation"};k.forEach(function(v,u){0===v[0]?(M||(n.push(P),
A=P.offset+P.toRemove,P={offset:A,toInsert:"",toRemove:0,type:"Operation"}),A+=v[1].length,P.offset=A):1===v[0]?P.toInsert=v[1]:P.toRemove=v[1].length;u===k.length-1&&0!==v[0]&&n.push(P);M&&=!1});return n};R.exports.diff=function(k,n){return G(m(k,n))}},"Patch.js":function(R,X,V){var m=V("./Common"),G=V("./Operation"),k=V("./sha256"),n=R.exports,A=n.create=function(h,B){h=Object.freeze({type:"Patch",operations:[],parentHash:h,isCheckpoint:!!B,mut:{inverseOf:void 0}});B&&(h.mut.inverseOf=h);return h},
M=n.check=function(h,B){m.assert("Patch"===h.type);m.assert(Array.isArray(h.operations));m.assert(/^[0-9a-f]{64}$/.test(h.parentHash));for(var e=h.operations.length-1;0<=e;e--)G.check(h.operations[e],B),0<e&&m.assert(!G.shouldMerge(h.operations[e],h.operations[e-1])),"number"===typeof B&&(B+=G.lengthChange(h.operations[e]));h.isCheckpoint&&(m.assert(1===h.operations.length),m.assert(0===h.operations[0].offset),"number"===typeof B&&m.assert(!B||h.operations[0].toRemove===B));return h};n.toObj=function(h){m.PARANOIA&&
M(h);var B=Array(h.operations.length+1),e;for(e=0;e<h.operations.length;e++)B[e]=G.toObj(h.operations[e]);B[e]=h.parentHash;return B};n.fromObj=function(h,B){m.assert(Array.isArray(h)&&0<h.length);B=A(k.check(h[h.length-1]),B);var e;for(e=0;e<h.length-1;e++)B.operations[e]=G.fromObj(h[e]);m.PARANOIA&&M(B);return B};var P=n.addOperation=function(h,B){m.PARANOIA&&(M(h),G.check(B));for(var e=0;e<h.operations.length;e++)if(G.shouldMerge(h.operations[e],B)){B=G.merge(h.operations[e],B);h.operations.splice(e,
1);if(null===B)return;e--}else{var C=G.rebase(h.operations[e],B);if(C===B){h.operations.splice(e,0,B);return}B=C}h.operations.push(B);m.PARANOIA&&M(h)};n.createCheckpoint=function(h,B,e){B=G.create(0,h.length,B);m.PARANOIA&&e&&m.assert(e===k.hex_sha256(h));e=e||k.hex_sha256(h);h=A(e,!0);h.operations[0]=B;return h};var v=n.clone=function(h){m.PARANOIA&&M(h);for(var B=A(h.parentHash,h.isCheckpoint),e=0;e<h.operations.length;e++)B.operations[e]=h.operations[e];return B};n.merge=function(h,B){m.PARANOIA&&
(M(h),M(B));if(h.isCheckpoint)return m.assert(B.parentHash===h.parentHash),B.isCheckpoint?A(h.parentHash):v(B);if(B.isCheckpoint)return v(h);h=v(h);for(var e=B.operations.length-1;0<=e;e--)P(h,B.operations[e]);return h};n.apply=function(h,B){m.PARANOIA&&(M(h),m.assert("string"===typeof B),m.assert(k.hex_sha256(B)===h.parentHash));for(var e=h.operations.length-1;0<=e;e--)B=G.apply(h.operations[e],B);return B};n.lengthChange=function(h){m.PARANOIA&&M(h);for(var B=0,e=0;e<h.operations.length;e++)B+=
G.lengthChange(h.operations[e]);return B};n.invert=function(h,B){m.PARANOIA&&(M(h),m.assert("string"===typeof B),m.assert(k.hex_sha256(B)===h.parentHash));var e=B;B=Array(h.operations.length);for(var C=h.operations.length-1;0<=C;C--)B[C]=G.invert(h.operations[C],e),e=G.apply(h.operations[C],e);C=Array(h.operations.length);for(var t=B.length-1;0<=t;t--){C[t]=B[t].offset;for(var K=t-1;0<=K;K--)C[t]+=B[K].toRemove-B[K].toInsert.length}h=A(k.hex_sha256(e),h.isCheckpoint);h.operations.splice(0,h.operations.length);
for(e=0;e<B.length;e++)h.operations[e]=G.create(C[e],B[e].toRemove,B[e].toInsert);m.PARANOIA&&M(h);return h};n.simplify=function(h,B,e){m.PARANOIA&&(M(h),m.assert("string"===typeof B),m.assert(k.hex_sha256(B)===h.parentHash));for(var C=A(h.parentHash),t=[],K=0,J=h.operations.length-1;0<=J;J--){var H=e(h.operations[J],B,G.simplify);H&&(B=G.apply(H,B),t[K++]=H)}Array.prototype.push.apply(C.operations,t.reverse());C.operations[0]||C.operations.shift();m.PARANOIA&&M(C);return C};n.equals=function(h,B){if(h.operations.length!==
B.operations.length)return!1;for(var e=0;e<h.operations.length;e++)if(!G.equals(h.operations[e],B.operations[e]))return!1;return!0};var u=function(h,B){return 0===h.offset&&h.toRemove===B.length&&h.toInsert===B};n.transform=function(h,B,e,C){if(m.PARANOIA&&(M(h,e.length),M(B,e.length),k.hex_sha256(e)!==h.parentHash))throw Error("wrong hash");if(h.parentHash!==B.parentHash)throw Error();var t=n.apply(B,e),K=A(B.mut.inverseOf?B.mut.inverseOf.parentHash:k.hex_sha256(t),h.isCheckpoint);if(0===B.operations.length)return v(h);
if(0===h.operations.length){if(h.isCheckpoint)throw Error();return K}if(h.isCheckpoint||1===h.operations.length&&u(h.operations[0],e))throw Error("Attempting to transform a checkpoint, this should not happen");if(1===B.operations.length&&u(B.operations[0],e)){if(!B.isCheckpoint)throw Error();return h}if(B.isCheckpoint)throw Error();h=C(h.operations,B.operations,e);Array.prototype.push.apply(K.operations,h);m.PARANOIA&&M(K,t.length);return K};n.random=function(h,B){m.assert("string"===typeof h);B=
B||Math.floor(30*Math.random())+1;var e=A(k.hex_sha256(h));for(h=h.length;0<B--;){var C=G.random(h);h+=G.lengthChange(C);P(e,C)}M(e);return e};Object.freeze(R.exports)},"SHA256.js":function(R,X,V){(function(){function m(k,n){var A=(k&65535)+(n&65535);return(k>>16)+(n>>16)+(A>>16)<<16|A&65535}function G(k,n){return k>>>n|k<<32-n}R.exports.hex_sha256=function(k){for(var n=[],A=0;A<8*k.length;A+=8)n[A>>5]|=(k.charCodeAt(A/8)&255)<<24-A%32;var M=8*k.length;A=[1116352408,1899447441,3049323471,3921009573,
961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,
883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];k=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];for(var P=64,v=[];0<P;P--)v.push(void 0);var u,h;n[M>>5]|=128<<24-M%32;n[(M+64>>9<<4)+15]=M;for(u=0;u<n.length;u+=16){M=k[0];P=k[1];var B=k[2];var e=k[3];var C=k[4];var t=k[5];var K=k[6];var J=k[7];for(h=0;64>h;h++){var H=h;if(16>h)var Q=n[h+u];else{Q=v[h-2];Q=G(Q,17)^
G(Q,19)^Q>>>10;Q=m(Q,v[h-7]);var w=v[h-15];w=G(w,7)^G(w,18)^w>>>3;Q=m(m(Q,w),v[h-16])}v[H]=Q;H=C;H=G(H,6)^G(H,11)^G(H,25);H=m(m(m(m(J,H),C&t^~C&K),A[h]),v[h]);J=M;J=G(J,2)^G(J,13)^G(J,22);Q=m(J,M&P^M&B^P&B);J=K;K=t;t=C;C=m(e,H);e=B;B=P;P=M;M=m(H,Q)}k[0]=m(M,k[0]);k[1]=m(P,k[1]);k[2]=m(B,k[2]);k[3]=m(e,k[3]);k[4]=m(C,k[4]);k[5]=m(t,k[5]);k[6]=m(K,k[6]);k[7]=m(J,k[7])}n="";for(A=0;A<4*k.length;A++)n+="0123456789abcdef".charAt(k[A>>2]>>8*(3-A%4)+4&15)+"0123456789abcdef".charAt(k[A>>2]>>8*(3-A%4)&15);
return n}})()},"Common.js":function(R,X,V){R.exports.global=function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof global)return global;if("undefined"!==typeof window)return window;throw Error("no self, nor global, nor window");}();X=function(G){return"undefined"!==typeof localStorage&&localStorage[G]?localStorage[G]:R.exports.global[G]};var m=R.exports.PARANOIA=X("ChainPad_PARANOIA");R.exports.VALIDATE_ENTIRE_CHAIN_EACH_MSG=X("ChainPad_VALIDATE_ENTIRE_CHAIN_EACH_MSG");R.exports.TESTING=
X("ChainPad_TESTING");R.exports.assert=function(G){if(!G)throw Error("Failed assertion");};R.exports.isUint=function(G){return"number"===typeof G&&Math.floor(G)===G&&0<=G};R.exports.randomASCII=function(G){for(var k=[],n=0;n<G;n++)k[n]=String.fromCharCode(Math.floor(256*Math.random())%57+65);return k.join("")};R.exports.strcmp=function(G,k){if(m&&"string"!==typeof G)throw Error();if(m&&"string"!==typeof k)throw Error();return G===k?0:G>k?1:-1};Object.freeze(R.exports)},"sha256.js":function(R,X,V){var m=
V("./sha256/exports.js"),G=V("./SHA256.js"),k=V("./Common");R.exports.check=function(n){if("string"!==typeof n)throw Error();if(!/[a-f0-9]{64}/.test(n))throw Error();return n};R.exports.hex_sha256=function(n){n+="";for(var A=m.hex,M=n,P=new Uint8Array(M.length),v=0;v<M.length;v++)P[v]=M.charCodeAt(v)&255;A=A.call(m,P);if(k.PARANOIA&&(M=G.hex_sha256(n),M!==A)){try{throw Error();}catch(u){console.log({hashErr:u,badHash:n,asmHasher:m.hex,oldHasher:G.hex_sha256})}return M}return A};Object.freeze(R.exports)},
"Message.js":function(R,X,V){var m=V("./Common"),G=V("./Patch"),k=V("./sha256");X=R.exports;var n=X.PATCH=2,A=X.CHECKPOINT=4,M=X.check=function(h){m.assert("Message"===h.type);m.assert(h.messageType===n||h.messageType===A);G.check(h.content);m.assert("string"===typeof h.lastMsgHash);return h},P=X.create=function(h,B,e){h={type:"Message",messageType:h,content:B,lastMsgHash:e,hashOf:"",mut:{parentCount:void 0,isInitialMessage:!1,isFromMe:!1,parent:void 0,time:void 0,author:void 0,serverHash:void 0}};
h.hashOf=u(h);m.PARANOIA&&M(h);return Object.freeze(h)},v=X.toStr=X.toString=function(h){m.PARANOIA&&M(h);if(h.messageType===n||h.messageType===A){if(!h.content)throw Error();return JSON.stringify([h.messageType,G.toObj(h.content),h.lastMsgHash])}throw Error();};X.fromString=function(h){var B={};"object"===typeof h&&(B=h,h=h.msg);h=JSON.parse(h);if(h[0]!==A&&h[0]!==n)throw Error("invalid message type "+h[0]);h=P(h[0],G.fromObj(h[1],h[0]===A),h[2]);h.mut.author=B.author;h.mut.time=B.time&&new Date(B.time);
h.mut.serverHash=B.serverHash;return Object.freeze(h)};var u=X.hashOf=function(h){m.PARANOIA&&M(h);return k.hex_sha256(v(h))};Object.freeze(R.exports)},"ChainPad.js":function(R,X,V){var m=R.exports.Common=V("./Common"),G=R.exports.Operation=V("./Operation"),k=R.exports.Patch=V("./Patch"),n=R.exports.Message=V("./Message"),A=R.exports.Sha=V("./sha256"),M=R.exports.Diff=V("./Diff"),P=R.exports.TextTransformer=V("./transform/TextTransformer");R.exports.NaiveJSONTransformer=V("./transform/NaiveJSONTransformer");
R.exports.SmartJSONTransformer=V("./transform/SmartJSONTransformer");var v=R.exports.EMPTY_STR_HASH="e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",u=function(c,p){1<c.logLevel&&console.log("["+c.userName+"]  "+p)},h=function(c,p){0<c.logLevel&&console.error("["+c.userName+"]  "+p)},B=function(c,p,I){if(!c.aborted){I||=Math.floor(2*Math.random()*c.config.avgSyncMilliseconds);var z=setTimeout(function(){c.schedules.splice(c.schedules.indexOf(z),1);p()},I);c.schedules.push(z);return z}},
e=function(c,p){var I=c.schedules.indexOf(p);-1<I&&c.schedules.splice(I,1);clearTimeout(p)},C=function(c,p,I){c.messageHandlers.length||I("no onMessage() handler registered");try{c.messageHandlers.forEach(function(z){z(p,function(){I.apply(null,arguments);I=function(){}})})}catch(z){I(z.stack)}},t=function(c,p,I,z){var y=n.toStr(p);C(c,y,function(l){if(l)u(c,"Posting to server failed ["+l+"]"),c.pending=null,c.syncSchedule=B(c,function(){H(c)});else{l=c.pending;c.pending=null;if(!l)throw Error();
m.assert(l.hash===p.hashOf);ta(c,y,!0)?(c.timeOfLastSuccess=+new Date,c.lag=+new Date-l.timeSent):u(c,"Our message ["+p.hashOf+"] failed validation");l.callback()}});if(c.pending)throw Error("there is already a pending message");-1===c.timeOfLastSuccess&&(c.timeOfLastSuccess=+new Date);c.pending={hash:p.hashOf,timeSent:z||+new Date,callback:function(){c.syncSchedule=B(c,function(){H(c)},0);I()}};m.PARANOIA&&x(c)},K=function(c){var p=c.onSettle;c.onSettle=[];p.forEach(function(I){try{I()}catch(z){h(c,
"Error in onSettle handler ["+z.stack+"]")}})},J=function(c){if(!c.mut.inverseOf)throw Error();return c.mut.inverseOf},H=function(c,p){m.PARANOIA&&x(c);if(c.syncSchedule&&!c.pending)if(e(c,c.syncSchedule),c.syncSchedule=null,c.uncommitted=k.simplify(c.uncommitted,c.authDoc,c.config.operationSimplify),0===c.uncommitted.operations.length)K(c),c.timeOfLastSuccess=+new Date,c.syncSchedule=B(c,function(){H(c)});else{var I=Z(c,c.best)+1;if(0===I%c.config.checkpointInterval){var z=c.best;u(c,"Sending checkpoint (interval ["+
c.config.checkpointInterval+"]) patch no ["+I+"]");u(c,Z(c,c.best));if(!z||!z.content||!J(z.content))throw Error();I=k.createCheckpoint(c.authDoc,c.authDoc,J(z.content).parentHash);z=n.create(n.CHECKPOINT,I,z.hashOf);t(c,z,function(){u(c,"Checkpoint sent and accepted")},p)}else{var y=c.setContentPatch?c.setContentPatch:n.create(n.PATCH,c.uncommitted,c.best.hashOf);t(c,y,function(){c.setContentPatch&&(u(c,"initial Ack received ["+y.hashOf+"]"),c.setContentPatch=null)},p)}}},Q=function(c,p){m.assert(p.lastMsgHash);
m.assert(p.hashOf);c.messages[p.hashOf]=p;(c.messagesByParent[p.lastMsgHash]=c.messagesByParent[p.lastMsgHash]||[]).push(p)},w=function(c,p){m.assert(p.lastMsgHash);m.assert(p.hashOf);delete c.messages[p.hashOf];var I=c.messagesByParent[p.lastMsgHash];m.assert(-1<I.indexOf(p));I.splice(I.indexOf(p),1);0===I.length&&delete c.messagesByParent[p.lastMsgHash];if(c=c.messagesByParent[p.hashOf])for(p=0;p<c.length;p++)delete c[p].mut.parent},F=function(c){var p=k.create(v);pa(p,"");p=n.create(n.PATCH,p,
"0000000000000000000000000000000000000000000000000000000000000000");p.mut.parentCount=0;p.mut.isInitialMessage=!0;var I=p;if(""!==c.initialState){var z=k.create(v);k.addOperation(z,G.create(0,0,c.initialState));pa(z,"");z=n.create(n.PATCH,z,p.hashOf);z.mut.isInitialMessage=!0;I=z}c={type:"ChainPad",authDoc:c.initialState,config:c,logLevel:c.logLevel,uncommitted:k.create(J(I.content).parentHash),patchHandlers:[],changeHandlers:[],messageHandlers:[],schedules:[],aborted:!1,syncSchedule:-2,userInterfaceContent:c.initialState,
setContentPatch:z,pending:void 0,messages:{},messagesByParent:{},rootMessage:p,onSettle:[],userName:c.userName,best:I,lag:0,timeOfLastSuccess:-1};Q(c,p);z&&Q(c,z);return c},L=function(c,p){return p.mut.parent=p.mut.parent||c.messages[p.lastMsgHash]},x=function(c){m.assert("ChainPad"===c.type);m.assert("string"===typeof c.authDoc);k.check(c.uncommitted,c.authDoc.length);var p=k.apply(c.uncommitted,c.authDoc);m.assert(p.length===N(c));""!==c.userInterfaceContent&&m.assert(p===c.userInterfaceContent);
if(m.VALIDATE_ENTIRE_CHAIN_EACH_MSG){p=c.authDoc;var I=c.best;m.assert(J(I.content).parentHash===c.uncommitted.parentHash);var z=[];do z.push(I),p=k.apply(J(I.content),p);while(I=L(c,I));if(c.rootMessage.content.isCheckpoint){if(p!==c.rootMessage.content.operations[0].toInsert)throw Error();}else if(""!==p)throw Error();for(;I=z.pop();)p=k.apply(I.content,p);m.assert(p===c.authDoc)}},N=function(c){return c.authDoc.length+k.lengthChange(c.uncommitted)},ma=function(c,p,I){if(!p)return!1;for(;;){if(!I)return!1;
if(p===I)return!0;I=L(c,I)}},Z=function(c,p){if("number"===typeof p.mut.parentCount)return p.mut.parentCount;for(var I=[];"number"!==typeof p.mut.parentCount;p=L(c,p)){if(!p){if(p===c.rootMessage)throw Error("root message does not have parent count");throw Error("parentCount called on unlinked message");}I.unshift(p)}c=p.mut.parentCount;for(p=0;p<I.length;p++)I[p].mut.parentCount=++c;return c},na=function(c,p,I){m.assert(I);if(p)m.assert(I.parentHash===c.uncommitted.parentHash),c.uncommitted=k.merge(J(I),
c.uncommitted);else if(c.uncommitted=k.transform(c.uncommitted,I,c.authDoc,c.config.patchTransformer),c.config.validateContent){var z=k.apply(I,c.authDoc);p=k.apply(c.uncommitted,z);c.config.validateContent(p)||(h(c,"Transformed patch is not valid"),c.uncommitted=k.create(A.hex_sha256(c.authDoc)))}m.assert(c.uncommitted.parentHash===J(I).parentHash);c.authDoc=z||k.apply(I,c.authDoc);m.PARANOIA&&(m.assert(c.uncommitted.parentHash===J(I).parentHash),m.assert(A.hex_sha256(c.authDoc)===c.uncommitted.parentHash),
c.userInterfaceContent=k.apply(c.uncommitted,c.authDoc))},da=function(c,p){var I=p;(c.messagesByParent[p.hashOf]||[]).forEach(function(z){m.assert(z.lastMsgHash===p.hashOf);z=da(c,z);Z(c,z)>Z(c,I)&&(I=z)});return I},ia=function(c,p){p.operations.length&&(c.patchHandlers.forEach(function(I){I(p)}),c.changeHandlers.forEach(function(I){p.operations.forEach(function(z){I(z.offset,z.toRemove,z.toInsert)})}))},oa=function(c,p){try{return c.config.validateContent(p())}catch(I){h(c,"Error in content validator ["+
I.stack+"]")}return!1},qa=function(c,p,I){for(p=L(c,p);p&&!1!==I(p);p=L(c,p));},pa=function(c,p){c.mut.inverseOf||((c.mut.inverseOf=k.invert(c,p)).mut.inverseOf=c)},ta=function(c,p,I){m.PARANOIA&&x(c);var z=n.fromString(p);u(c,JSON.stringify([z.hashOf,z.content.operations]));if(c.messages[z.hashOf]){if(c.setContentPatch&&c.setContentPatch.hashOf===z.hashOf)c.setContentPatch=null;else{if(z.content.isCheckpoint)return u(c,"["+(I?"our":"their")+"] Checkpoint ["+z.hashOf+"] is already known"),!0;u(c,
"Patch ["+z.hashOf+"] is already known")}m.PARANOIA&&x(c)}else if(z.content.isCheckpoint&&!oa(c,function(){return z.content.operations[0].toInsert}))u(c,"Checkpoint ["+z.hashOf+"] failed content validation");else if(Q(c,z),ma(c,c.rootMessage,z)){z=da(c,z);z.mut.isFromMe=I;var y=z.content;p=[];I=c.best;if(!ma(c,c.best,z)){var l=Z(c,c.best),O=Z(c,z);if(l<O||l===O&&0<m.strcmp(c.best.hashOf,z.hashOf)){for(;I&&!ma(c,I,z);)p.push(I),I=L(c,I);m.assert(I);u(c,"Patch ["+z.hashOf+"] better than best chain, switching")}else return u(c,
"Patch ["+z.hashOf+"] chain is ["+O+"] best chain is ["+l+"]"),m.PARANOIA&&x(c),!0}var S=[];l=z;do S.unshift(l),l=L(c,l),m.assert(l);while(l!==I);var U=c.authDoc;p.forEach(function(T){U=k.apply(J(T.content),U)});S.forEach(function(T,aa){aa!==S.length-1&&(pa(T.content,U),U=k.apply(T.content,U))});I=c.best;1<S.length?(I=S[S.length-2],m.assert(I)):p.length&&(I=L(c,p[p.length-1]),m.assert(I));m.assert(J(I.content).parentHash);m.assert(!m.PARANOIA||J(I.content).parentHash===A.hex_sha256(U));if(J(I.content).parentHash!==
y.parentHash){u(c,"patch ["+z.hashOf+"] parentHash is not valid");m.PARANOIA&&x(c);if(m.TESTING)throw Error();w(c,z)}else{if(!y.isCheckpoint||!c.config.noPrune)if(y.isCheckpoint){var Y;qa(c,z,function(T){if(T.content.isCheckpoint){if(Y)return Y=T,!1;Y=T}});if(Y&&Y!==c.rootMessage){I=Z(c,Y);if(c.config.strictCheckpointValidation&&0!==I%c.config.checkpointInterval){u(c,"checkpoint ["+z.hashOf+"] at invalid point ["+I+"]");m.PARANOIA&&x(c);if(m.TESTING)throw Error();w(c,z);return}u(c,"checkpoint ["+
z.hashOf+"]");qa(c,Y,function(T){u(c,"pruning ["+T.hashOf+"]");w(c,T)});c.rootMessage=Y}}else{I=k.simplify(y,U,c.config.operationSimplify);if(!k.equals(I,y)){u(c,"patch ["+z.hashOf+"] can be simplified");m.PARANOIA&&x(c);if(m.TESTING)throw Error();w(c,z);return}if(!oa(c,function(){return k.apply(y,U)})){u(c,"Patch ["+z.hashOf+"] failed content validation");return}}pa(y,U);c.uncommitted=k.simplify(c.uncommitted,c.authDoc,c.config.operationSimplify);I=k.apply(c.uncommitted,c.authDoc);m.PARANOIA&&m.assert(I===
c.userInterfaceContent);var W=k.invert(c.uncommitted,c.authDoc);p.forEach(function(T){u(c,"reverting ["+T.hashOf+"]");T.mut.isFromMe&&u(c,"reverting patch 'from me' ["+JSON.stringify(T.content.operations)+"]");W=k.merge(W,J(T.content));na(c,T.mut.isFromMe,J(T.content))});S.forEach(function(T){u(c,"applying ["+T.hashOf+"]");W=k.merge(W,T.content);na(c,T.mut.isFromMe,T.content)});W=k.merge(W,c.uncommitted);W=k.simplify(W,I,c.config.operationSimplify);c.best=z;m.PARANOIA&&(p=k.apply(W,I),m.assert(c.userInterfaceContent.length===
N(c)),m.assert(p===c.userInterfaceContent));ia(c,W);c.uncommitted.operations.length||K(c);m.PARANOIA&&x(c);return!0}}else{if(z.content.isCheckpoint&&c.best.mut.isInitialMessage)return u(c,"applying checkpoint ["+z.hashOf+"]"),p=k.apply(c.uncommitted,c.authDoc),m.assert(!m.PARANOIA||c.userInterfaceContent===p),I=k.invert(c.uncommitted,c.authDoc),k.addOperation(I,G.create(0,c.authDoc.length,z.content.operations[0].toInsert)),I=k.simplify(I,p,c.config.operationSimplify),z.mut.parentCount=0,c.rootMessage=
c.best=z,c.authDoc=z.content.operations[0].toInsert,c.uncommitted=k.create(A.hex_sha256(c.authDoc)),ia(c,I),m.PARANOIA&&(c.userInterfaceContent=c.authDoc),!0;u(c,"Patch ["+z.hashOf+"] not connected to root (parent: ["+z.lastMsgHash+"])");m.PARANOIA&&x(c)}},ra=function(c,p){return Object.freeze({type:"Block",hashOf:p.hashOf,lastMsgHash:p.lastMsgHash,isCheckpoint:!!p.content.isCheckpoint,isFromMe:p.mut&&p.mut.isFromMe,author:p.mut&&p.mut.author,serverHash:p.mut&&p.mut.serverHash,time:p.mut&&p.mut.time,
getParent:function(){var I=L(c,p);if(I)return ra(c,I)},getContent:function(){var I;a:{for(I=[p];I[0]!==c.rootMessage;){var z=L(c,I[0]);if(!z){I={error:"not connected to root",doc:void 0};break a}I.unshift(z)}z="";c.rootMessage.content.operations.length&&(m.assert(1===c.rootMessage.content.operations.length),z=c.rootMessage.content.operations[0].toInsert);for(var y=1;y<I.length;y++)z=k.apply(I[y].content,z);I={error:void 0,doc:z}}return I},getPatch:function(){return k.clone(p.content)},getInversePatch:function(){return k.clone(J(p.content))},
equals:function(I,z){return z?p===z:I&&"object"===typeof I&&"Block"===I.type?I.equals(I,p):!1}})},ua=function(c){c=c||{};if(c.transformFunction)throw Error("chainpad config transformFunction is nolonger used");return Object.freeze({initialState:c.initialState||"",checkpointInterval:c.checkpointInterval||50,avgSyncMilliseconds:c.avgSyncMilliseconds||300,strictCheckpointValidation:c.strictCheckpointValidation||!1,operationSimplify:c.operationSimplify||G.simplify,logLevel:"number"===typeof c.logLevel?
c.logLevel:2,noPrune:c.noPrune,patchTransformer:c.patchTransformer||P,userName:c.userName||"anonymous",validateContent:c.validateContent||function(p){return!0},diffFunction:c.diffFunction||function(p,I){return M.diff(p,I)}})};R.exports.create=function(c){var p=F(ua(c)),I={onPatch:function(z){m.assert("function"===typeof z);p.patchHandlers.push(z)},patch:function(z,y,l){if("number"===typeof z){if("number"!==typeof y||"string"!==typeof l)throw Error();I.change(z,y,l)}else m.PARANOIA&&(x(p),m.assert(k.invert(p.uncommitted,
p.authDoc).parentHash===z.parentHash),p.userInterfaceContent=k.apply(z,p.userInterfaceContent)),k.check(z,N(p)),p.uncommitted=k.merge(p.uncommitted,z)},onChange:function(z){m.assert("function"===typeof z);p.changeHandlers.push(z)},change:function(z,y,l){if(0!==y||""!==l)z=G.create(z,y,l),m.PARANOIA&&(x(p),p.userInterfaceContent=G.apply(z,p.userInterfaceContent)),G.check(z,N(p)),k.addOperation(p.uncommitted,z)},contentUpdate:function(z){z=p.config.diffFunction(p.authDoc,z);var y=k.create(p.uncommitted.parentHash);
Array.prototype.push.apply(y.operations,z);p.uncommitted=y},onMessage:function(z){m.assert("function"===typeof z);p.messageHandlers.push(z)},message:function(z){ta(p,z,!1)},start:function(){p.aborted=!1;p.syncSchedule&&e(p,p.syncSchedule);p.pending=null;p.syncSchedule=B(p,function(){H(p)})},abort:function(){p.aborted=!0;p.schedules.forEach(function(z){clearTimeout(z)})},sync:function(){H(p)},getAuthDoc:function(){return p.authDoc},getUserDoc:function(){return k.apply(p.uncommitted,p.authDoc)},getDepthOfState:function(z,
y){a:if(m.assert("string"===typeof z),y=y||0,0===y&&p.authDoc===z)y=0;else{z=A.hex_sha256(z);var l=p.best,O=0;do{if(!(O<y)&&l.content.parentHash===z){y=O+1;break a}O++}while(l=L(p,l));y=-1}return y},onSettle:function(z){m.assert("function"===typeof z);p.onSettle.push(z)},getAuthBlock:function(){return ra(p,p.best)},getBlockForHash:function(z){m.assert("string"===typeof z);if(z=p.messages[z])return ra(p,z)},getLag:function(){var z=!!p.pending,y=p.lag;p.pending&&(y=+new Date-p.timeOfLastSuccess);return{pending:z,
lag:y,active:!p.aborted&&-2!==p.syncSchedule}},_:void 0};I._=p;return Object.freeze(I)};Object.freeze(R.exports)},"Operation.js":function(R,X,V){var m=V("./Common");X=R.exports;var G=X.check=function(v,u){m.assert("Operation"===v.type);if(!m.isUint(v.offset))throw Error();if(!m.isUint(v.toRemove))throw Error();if("string"!==typeof v.toInsert)throw Error();if(1>v.toRemove&&1>v.toInsert.length)throw Error();m.assert("number"!==typeof u||v.offset+v.toRemove<=u);return v},k=X.create=function(v,u,h){v=
{type:"Operation",offset:v||0,toRemove:u||0,toInsert:h||""};m.PARANOIA&&G(v);return Object.freeze(v)};X.toObj=function(v){m.PARANOIA&&G(v);return[v.offset,v.toRemove,v.toInsert]};X.fromObj=function(v){m.assert(Array.isArray(v)&&3===v.length);return k(v[0],v[1],v[2])};var n=X.apply=function(v,u){m.PARANOIA&&(m.assert("string"===typeof u),G(v,u.length));return u.substring(0,v.offset)+v.toInsert+u.substring(v.offset+v.toRemove)};X.applyMulti=function(v,u){for(var h=v.length-1;0<=h;h--)u=n(v[h],u);return u};
var A=X.invert=function(v,u){m.PARANOIA&&(G(v),m.assert("string"===typeof u),m.assert(v.offset+v.toRemove<=u.length));return k(v.offset,v.toInsert.length,(" "+u.substring(v.offset,v.offset+v.toRemove)).slice(1))},M=/[\uD800-\uDBFF]|[\uDC00-\uDFFF]/,P=X.hasSurrogate=function(v){return M.test(v)};X.simplify=function(v,u){m.PARANOIA&&(G(v),m.assert("string"===typeof u),m.assert(v.offset+v.toRemove<=u.length));var h=A(v,u),B=Math.min(v.toInsert.length,h.toInsert.length);for(u=0;u<B&&h.toInsert[u]===v.toInsert[u];){if(P(h.toInsert[u])||
P(v.toInsert[u]))if(v.toInsert[u+1]===h.toInsert[u+1])u++;else break;u++}B=v.offset+u;var e=v.toRemove-u;v=v.toInsert.substring(u);h=h.toInsert.substring(u);if(h.length===v.length){for(u=h.length-1;0<=u&&h[u]===v[u];u--);v=v.substring(0,u+1);e=u+1}return 0===e&&0===v.length?null:k(B,e,v)};X.equals=function(v,u){return v.toRemove===u.toRemove&&v.toInsert===u.toInsert&&v.offset===u.offset};X.lengthChange=function(v){m.PARANOIA&&G(v);return v.toInsert.length-v.toRemove};X.merge=function(v,u){m.PARANOIA&&
(G(u),G(v));var h=v.offset,B=v.toRemove,e=v.toInsert,C=u.toRemove,t=u.toInsert,K=u.offset-h;if(0<C){var J=e;e=e.substring(0,K)+e.substring(K+C);C-=J.length-e.length;0>C&&(C=0);B+=C}if(0>K)h+=K,e=t+e;else if(e.length===K)e+=t;else if(e.length>K)e=e.substring(0,K)+t+e.substring(K);else throw Error("should never happen\n"+JSON.stringify([v,u],null,"  "));return""===e&&0===B?null:k(h,B,e)};X.shouldMerge=function(v,u){m.PARANOIA&&(G(v),G(u));return u.offset<v.offset?v.offset<=u.offset+u.toRemove:u.offset<=
v.offset+v.toInsert.length};X.rebase=function(v,u){m.PARANOIA&&(G(v),G(u));return u.offset<v.offset?u:k(u.offset+v.toRemove-v.toInsert.length,u.toRemove,u.toInsert)};X.random=function(v){m.assert(m.isUint(v));var u=Math.floor(1E8*Math.random()%v)||0;v=Math.floor(1E8*Math.random()%(v-u))||0;do var h=m.randomASCII(Math.floor(20*Math.random()));while(0===v&&""===h);return k(u,v,h)};Object.freeze(R.exports)},"sha256/hash.js":function(R,X,V){var m=V("./utils.js");R.exports.hash_reset=function(){this.result=
null;this.len=this.pos=0;this.asm.reset();return this};R.exports.hash_process=function(G){if(null!==this.result)throw new IllegalStateError("state must be reset before processing new data");m.is_string(G)&&(G=m.string_to_bytes(G));m.is_buffer(G)&&(G=new Uint8Array(G));if(!m.is_bytes(G))throw new TypeError("data isn't of expected type");for(var k=this.asm,n=this.heap,A=this.pos,M=this.len,P=0,v=G.length,u;0<v;)u=m._heap_write(n,A+M,G,P,v),M+=u,P+=u,v-=u,u=k.process(A,M),A+=u,(M-=u)||(A=0);this.pos=
A;this.len=M;return this};R.exports.hash_finish=function(){if(null!==this.result)throw new IllegalStateError("state must be reset before processing new data");this.asm.finish(this.pos,this.len,0);this.result=new Uint8Array(this.HASH_SIZE);this.result.set(this.heap.subarray(0,this.HASH_SIZE));this.len=this.pos=0;return this}},"sha256/utils.js":function(R,X,V){var m=R.exports.string_to_bytes=function(k,n){n=!!n;for(var A=k.length,M=new Uint8Array(n?4*A:A),P=0,v=0;P<A;P++){var u=k.charCodeAt(P);if(n&&
55296<=u&&56319>=u){if(++P>=A)throw Error("Malformed string, low surrogate expected at position "+P);u=(u^55296)<<10|65536|k.charCodeAt(P)^56320}else if(!n&&u>>>8)throw Error("Wide characters are not allowed.");!n||127>=u?M[v++]=u:(2047>=u?M[v++]=192|u>>6:(65535>=u?M[v++]=224|u>>12:(M[v++]=240|u>>18,M[v++]=128|u>>12&63),M[v++]=128|u>>6&63),M[v++]=128|u&63)}return M.subarray(0,v)};R.exports.hex_to_bytes=function(k){var n=k.length;n&1&&(k="0"+k,n++);for(var A=new Uint8Array(n>>1),M=0;M<n;M+=2)A[M>>
1]=parseInt(k.substr(M,2),16);return A};R.exports.base64_to_bytes=function(k){return m(atob(k))};var G=R.exports.bytes_to_string=function(k,n){n=!!n;for(var A=k.length,M=Array(A),P=0,v=0;P<A;P++){var u=k[P];if(!n||128>u)M[v++]=u;else if(192<=u&&224>u&&P+1<A)M[v++]=(u&31)<<6|k[++P]&63;else if(224<=u&&240>u&&P+2<A)M[v++]=(u&15)<<12|(k[++P]&63)<<6|k[++P]&63;else if(240<=u&&248>u&&P+3<A)u=(u&7)<<18|(k[++P]&63)<<12|(k[++P]&63)<<6|k[++P]&63,65535>=u?M[v++]=u:(u^=65536,M[v++]=55296|u>>10,M[v++]=56320|u&
1023);else throw Error("Malformed UTF8 character at byte offset "+P);}k="";for(n=0;n<v;n+=16384)k+=String.fromCharCode.apply(String,M.slice(n,n+16384<=v?n+16384:v));return k};R.exports.bytes_to_hex=function(k){for(var n="",A=0;A<k.length;A++){var M=(k[A]&255).toString(16);2>M.length&&(n+="0");n+=M}return n};R.exports.bytes_to_base64=function(k){return btoa(G(k))};R.exports.pow2_ceil=function(k){--k;k|=k>>>1;k|=k>>>2;k|=k>>>4;k|=k>>>8;return(k|k>>>16)+1};R.exports.is_number=function(k){return"number"===
typeof k};R.exports.is_string=function(k){return"string"===typeof k};R.exports.is_buffer=function(k){return k instanceof ArrayBuffer};R.exports.is_bytes=function(k){return k instanceof Uint8Array};R.exports.is_typed_array=function(k){return k instanceof Int8Array||k instanceof Uint8Array||k instanceof Int16Array||k instanceof Uint16Array||k instanceof Int32Array||k instanceof Uint32Array||k instanceof Float32Array||k instanceof Float64Array};R.exports._heap_init=function(k,n){var A=n.heap;n=A?A.byteLength:
n.heapSize||65536;if(n&4095||0>=n)throw Error("heap size must be a positive integer and a multiple of 4096");return A=A||new k(new ArrayBuffer(n))};R.exports._heap_write=function(k,n,A,M,P){var v=k.length-n;P=v<P?v:P;k.set(A.subarray(M,M+P),n);return P}},"sha256/sha256.js":function(R,X,V){function m(A){A=A||{};this.heap=G._heap_init(Uint8Array,A);this.asm=A.asm||k.sha256_asm({Uint8Array},null,this.heap.buffer);this.BLOCK_SIZE=64;this.HASH_SIZE=32;this.reset()}var G=V("./utils.js");X=V("./hash.js");
var k=V("./sha256.asm.js");m.BLOCK_SIZE=64;m.HASH_SIZE=32;V=m.prototype;V.reset=X.hash_reset;V.process=X.hash_process;V.finish=X.hash_finish;var n=null;R.exports.get_sha256_instance=function(){null===n&&(n=new m({heapSize:1048576}));return n};R.exports.sha256_constructor=m},"sha256/exports.js":function(R,X,V){function m(n){if(void 0===n)throw new SyntaxError("data required");return G.get_sha256_instance().reset().process(n).finish().result}var G=V("./sha256.js"),k=V("./utils.js");G.sha256_constructor.bytes=
m;G.sha256_constructor.hex=function(n){n=m(n);return k.bytes_to_hex(n)};G.sha256_constructor.base64=function(n){n=m(n);return k.bytes_to_base64(n)};R.exports=G.sha256_constructor},"sha256/sha256.asm.js":function(R,X,V){R.exports.sha256_asm=function(m,G,k){function n(l,O,S,U,Y,W,T,aa,ba,ca,ea,fa,ha,ja,ka,la){l|=0;O|=0;S|=0;U|=0;Y|=0;W|=0;T|=0;aa|=0;ba|=0;ca|=0;ea|=0;fa|=0;ha|=0;ja|=0;ka|=0;la|=0;var D=C;var a=t;var f=K;var q=J;var b=H;var r=Q;var g=w;var E=F;var d=l+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<
21^b<<7)+(g^b&(r^g))+1116352408|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;d=O+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+1899447441|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;d=S+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+3049323471|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;d=U+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^
g))+3921009573|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;d=Y+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+961987163|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;d=W+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+1508970993|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;d=T+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+2453635748|0;
E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;d=aa+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+2870763221|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;d=ba+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+3624381080|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;d=ca+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+310598401|0;E=g;g=r;r=b;b=
q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;d=ea+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+607225278|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;d=fa+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+1426881987|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;d=ha+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+1925078388|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;
a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;d=ja+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+2162078206|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;d=ka+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+2614888103|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;d=la+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+3248222580|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^
q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;l=d=(O>>>7^O>>>18^O>>>3^O<<25^O<<14)+(ka>>>17^ka>>>19^ka>>>10^ka<<15^ka<<13)+l+ca|0;d=d+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+3835390401|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;O=d=(S>>>7^S>>>18^S>>>3^S<<25^S<<14)+(la>>>17^la>>>19^la>>>10^la<<15^la<<13)+O+ea|0;d=d+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+4022224774|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+
(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;S=d=(U>>>7^U>>>18^U>>>3^U<<25^U<<14)+(l>>>17^l>>>19^l>>>10^l<<15^l<<13)+S+fa|0;d=d+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+264347078|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;U=d=(Y>>>7^Y>>>18^Y>>>3^Y<<25^Y<<14)+(O>>>17^O>>>19^O>>>10^O<<15^O<<13)+U+ha|0;d=d+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+604807628|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^
a<<30^a<<19^a<<10)|0;Y=d=(W>>>7^W>>>18^W>>>3^W<<25^W<<14)+(S>>>17^S>>>19^S>>>10^S<<15^S<<13)+Y+ja|0;d=d+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+770255983|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;W=d=(T>>>7^T>>>18^T>>>3^T<<25^T<<14)+(U>>>17^U>>>19^U>>>10^U<<15^U<<13)+W+ka|0;d=d+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+1249150122|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;
T=d=(aa>>>7^aa>>>18^aa>>>3^aa<<25^aa<<14)+(Y>>>17^Y>>>19^Y>>>10^Y<<15^Y<<13)+T+la|0;d=d+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+1555081692|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;aa=d=(ba>>>7^ba>>>18^ba>>>3^ba<<25^ba<<14)+(W>>>17^W>>>19^W>>>10^W<<15^W<<13)+aa+l|0;d=d+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+1996064986|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;ba=d=(ca>>>
7^ca>>>18^ca>>>3^ca<<25^ca<<14)+(T>>>17^T>>>19^T>>>10^T<<15^T<<13)+ba+O|0;d=d+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+2554220882|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;ca=d=(ea>>>7^ea>>>18^ea>>>3^ea<<25^ea<<14)+(aa>>>17^aa>>>19^aa>>>10^aa<<15^aa<<13)+ca+S|0;d=d+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+2821834349|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;ea=d=(fa>>>7^
fa>>>18^fa>>>3^fa<<25^fa<<14)+(ba>>>17^ba>>>19^ba>>>10^ba<<15^ba<<13)+ea+U|0;d=d+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+2952996808|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;fa=d=(ha>>>7^ha>>>18^ha>>>3^ha<<25^ha<<14)+(ca>>>17^ca>>>19^ca>>>10^ca<<15^ca<<13)+fa+Y|0;d=d+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+3210313671|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;ha=d=(ja>>>
7^ja>>>18^ja>>>3^ja<<25^ja<<14)+(ea>>>17^ea>>>19^ea>>>10^ea<<15^ea<<13)+ha+W|0;d=d+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+3336571891|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;ja=d=(ka>>>7^ka>>>18^ka>>>3^ka<<25^ka<<14)+(fa>>>17^fa>>>19^fa>>>10^fa<<15^fa<<13)+ja+T|0;d=d+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+3584528711|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;ka=d=(la>>>
7^la>>>18^la>>>3^la<<25^la<<14)+(ha>>>17^ha>>>19^ha>>>10^ha<<15^ha<<13)+ka+aa|0;d=d+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+113926993|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;la=d=(l>>>7^l>>>18^l>>>3^l<<25^l<<14)+(ja>>>17^ja>>>19^ja>>>10^ja<<15^ja<<13)+la+ba|0;d=d+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+338241895|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;l=d=(O>>>7^O>>>
18^O>>>3^O<<25^O<<14)+(ka>>>17^ka>>>19^ka>>>10^ka<<15^ka<<13)+l+ca|0;d=d+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+666307205|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;O=d=(S>>>7^S>>>18^S>>>3^S<<25^S<<14)+(la>>>17^la>>>19^la>>>10^la<<15^la<<13)+O+ea|0;d=d+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+773529912|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;S=d=(U>>>7^U>>>18^U>>>3^U<<
25^U<<14)+(l>>>17^l>>>19^l>>>10^l<<15^l<<13)+S+fa|0;d=d+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+1294757372|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;U=d=(Y>>>7^Y>>>18^Y>>>3^Y<<25^Y<<14)+(O>>>17^O>>>19^O>>>10^O<<15^O<<13)+U+ha|0;d=d+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+1396182291|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;Y=d=(W>>>7^W>>>18^W>>>3^W<<25^W<<14)+(S>>>17^S>>>
19^S>>>10^S<<15^S<<13)+Y+ja|0;d=d+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+1695183700|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;W=d=(T>>>7^T>>>18^T>>>3^T<<25^T<<14)+(U>>>17^U>>>19^U>>>10^U<<15^U<<13)+W+ka|0;d=d+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+1986661051|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;T=d=(aa>>>7^aa>>>18^aa>>>3^aa<<25^aa<<14)+(Y>>>17^Y>>>19^Y>>>10^Y<<15^
Y<<13)+T+la|0;d=d+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+2177026350|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;aa=d=(ba>>>7^ba>>>18^ba>>>3^ba<<25^ba<<14)+(W>>>17^W>>>19^W>>>10^W<<15^W<<13)+aa+l|0;d=d+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+2456956037|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;ba=d=(ca>>>7^ca>>>18^ca>>>3^ca<<25^ca<<14)+(T>>>17^T>>>19^T>>>10^T<<15^T<<13)+
ba+O|0;d=d+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+2730485921|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;ca=d=(ea>>>7^ea>>>18^ea>>>3^ea<<25^ea<<14)+(aa>>>17^aa>>>19^aa>>>10^aa<<15^aa<<13)+ca+S|0;d=d+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+2820302411|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;ea=d=(fa>>>7^fa>>>18^fa>>>3^fa<<25^fa<<14)+(ba>>>17^ba>>>19^ba>>>10^ba<<15^ba<<13)+
ea+U|0;d=d+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+3259730800|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;fa=d=(ha>>>7^ha>>>18^ha>>>3^ha<<25^ha<<14)+(ca>>>17^ca>>>19^ca>>>10^ca<<15^ca<<13)+fa+Y|0;d=d+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+3345764771|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;ha=d=(ja>>>7^ja>>>18^ja>>>3^ja<<25^ja<<14)+(ea>>>17^ea>>>19^ea>>>10^ea<<15^ea<<13)+
ha+W|0;d=d+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+3516065817|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;ja=d=(ka>>>7^ka>>>18^ka>>>3^ka<<25^ka<<14)+(fa>>>17^fa>>>19^fa>>>10^fa<<15^fa<<13)+ja+T|0;d=d+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+3600352804|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;ka=d=(la>>>7^la>>>18^la>>>3^la<<25^la<<14)+(ha>>>17^ha>>>19^ha>>>10^ha<<15^ha<<13)+
ka+aa|0;d=d+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+4094571909|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;la=d=(l>>>7^l>>>18^l>>>3^l<<25^l<<14)+(ja>>>17^ja>>>19^ja>>>10^ja<<15^ja<<13)+la+ba|0;d=d+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+275423344|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;l=d=(O>>>7^O>>>18^O>>>3^O<<25^O<<14)+(ka>>>17^ka>>>19^ka>>>10^ka<<15^ka<<13)+l+ca|0;
d=d+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+430227734|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;O=d=(S>>>7^S>>>18^S>>>3^S<<25^S<<14)+(la>>>17^la>>>19^la>>>10^la<<15^la<<13)+O+ea|0;d=d+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+506948616|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;S=d=(U>>>7^U>>>18^U>>>3^U<<25^U<<14)+(l>>>17^l>>>19^l>>>10^l<<15^l<<13)+S+fa|0;d=d+E+(b>>>6^b>>>
11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+659060556|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;U=d=(Y>>>7^Y>>>18^Y>>>3^Y<<25^Y<<14)+(O>>>17^O>>>19^O>>>10^O<<15^O<<13)+U+ha|0;d=d+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+883997877|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;Y=d=(W>>>7^W>>>18^W>>>3^W<<25^W<<14)+(S>>>17^S>>>19^S>>>10^S<<15^S<<13)+Y+ja|0;d=d+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^
b<<7)+(g^b&(r^g))+958139571|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;W=d=(T>>>7^T>>>18^T>>>3^T<<25^T<<14)+(U>>>17^U>>>19^U>>>10^U<<15^U<<13)+W+ka|0;d=d+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+1322822218|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;T=d=(aa>>>7^aa>>>18^aa>>>3^aa<<25^aa<<14)+(Y>>>17^Y>>>19^Y>>>10^Y<<15^Y<<13)+T+la|0;d=d+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+
1537002063|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;aa=d=(ba>>>7^ba>>>18^ba>>>3^ba<<25^ba<<14)+(W>>>17^W>>>19^W>>>10^W<<15^W<<13)+aa+l|0;d=d+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+1747873779|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;ba=d=(ca>>>7^ca>>>18^ca>>>3^ca<<25^ca<<14)+(T>>>17^T>>>19^T>>>10^T<<15^T<<13)+ba+O|0;d=d+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+1955562222|
0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;ca=d=(ea>>>7^ea>>>18^ea>>>3^ea<<25^ea<<14)+(aa>>>17^aa>>>19^aa>>>10^aa<<15^aa<<13)+ca+S|0;d=d+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+2024104815|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;ea=d=(fa>>>7^fa>>>18^fa>>>3^fa<<25^fa<<14)+(ba>>>17^ba>>>19^ba>>>10^ba<<15^ba<<13)+ea+U|0;d=d+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+2227730452|
0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;fa=d=(ha>>>7^ha>>>18^ha>>>3^ha<<25^ha<<14)+(ca>>>17^ca>>>19^ca>>>10^ca<<15^ca<<13)+fa+Y|0;d=d+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+2361852424|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;ha=d=(ja>>>7^ja>>>18^ja>>>3^ja<<25^ja<<14)+(ea>>>17^ea>>>19^ea>>>10^ea<<15^ea<<13)+ha+W|0;d=d+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+2428436474|
0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;ja=d=(ka>>>7^ka>>>18^ka>>>3^ka<<25^ka<<14)+(fa>>>17^fa>>>19^fa>>>10^fa<<15^fa<<13)+ja+T|0;d=d+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+2756734187|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;d=((la>>>7^la>>>18^la>>>3^la<<25^la<<14)+(ha>>>17^ha>>>19^ha>>>10^ha<<15^ha<<13)+ka+aa|0)+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+3204031479|0;
E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;D=d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0;d=((l>>>7^l>>>18^l>>>3^l<<25^l<<14)+(ja>>>17^ja>>>19^ja>>>10^ja<<15^ja<<13)+la+ba|0)+E+(b>>>6^b>>>11^b>>>25^b<<26^b<<21^b<<7)+(g^b&(r^g))+3329325298|0;E=g;g=r;r=b;b=q+d|0;q=f;f=a;a=D;C=C+(d+(a&f^q&(a^f))+(a>>>2^a>>>13^a>>>22^a<<30^a<<19^a<<10)|0)|0;t=t+a|0;K=K+f|0;J=J+q|0;H=H+b|0;Q=Q+r|0;w=w+g|0;F=F+E|0}function A(l){l|=0;n(y[l|0]<<24|y[l|1]<<16|y[l|2]<<8|y[l|3],y[l|4]<<24|y[l|5]<<16|y[l|6]<<8|y[l|7],y[l|8]<<
24|y[l|9]<<16|y[l|10]<<8|y[l|11],y[l|12]<<24|y[l|13]<<16|y[l|14]<<8|y[l|15],y[l|16]<<24|y[l|17]<<16|y[l|18]<<8|y[l|19],y[l|20]<<24|y[l|21]<<16|y[l|22]<<8|y[l|23],y[l|24]<<24|y[l|25]<<16|y[l|26]<<8|y[l|27],y[l|28]<<24|y[l|29]<<16|y[l|30]<<8|y[l|31],y[l|32]<<24|y[l|33]<<16|y[l|34]<<8|y[l|35],y[l|36]<<24|y[l|37]<<16|y[l|38]<<8|y[l|39],y[l|40]<<24|y[l|41]<<16|y[l|42]<<8|y[l|43],y[l|44]<<24|y[l|45]<<16|y[l|46]<<8|y[l|47],y[l|48]<<24|y[l|49]<<16|y[l|50]<<8|y[l|51],y[l|52]<<24|y[l|53]<<16|y[l|54]<<8|y[l|
55],y[l|56]<<24|y[l|57]<<16|y[l|58]<<8|y[l|59],y[l|60]<<24|y[l|61]<<16|y[l|62]<<8|y[l|63])}function M(l){l|=0;y[l|0]=C>>>24;y[l|1]=C>>>16&255;y[l|2]=C>>>8&255;y[l|3]=C&255;y[l|4]=t>>>24;y[l|5]=t>>>16&255;y[l|6]=t>>>8&255;y[l|7]=t&255;y[l|8]=K>>>24;y[l|9]=K>>>16&255;y[l|10]=K>>>8&255;y[l|11]=K&255;y[l|12]=J>>>24;y[l|13]=J>>>16&255;y[l|14]=J>>>8&255;y[l|15]=J&255;y[l|16]=H>>>24;y[l|17]=H>>>16&255;y[l|18]=H>>>8&255;y[l|19]=H&255;y[l|20]=Q>>>24;y[l|21]=Q>>>16&255;y[l|22]=Q>>>8&255;y[l|23]=Q&255;y[l|24]=
w>>>24;y[l|25]=w>>>16&255;y[l|26]=w>>>8&255;y[l|27]=w&255;y[l|28]=F>>>24;y[l|29]=F>>>16&255;y[l|30]=F>>>8&255;y[l|31]=F&255}function P(){C=1779033703;t=3144134277;K=1013904242;J=2773480762;H=1359893119;Q=2600822924;w=528734635;F=1541459225;L=x=0}function v(l,O){l|=0;O|=0;var S=0;if(l&63)return-1;for(;64<=(O|0);)A(l),l=l+64|0,O=O-64|0,S=S+64|0;L=L+S|0;L>>>0<S>>>0&&(x=x+1|0);return S|0}function u(l,O,S){l|=0;O|=0;S|=0;var U=0;if(l&63||~S&&S&31)return-1;if(64<=(O|0)){U=v(l,O)|0;if(-1==(U|0))return-1;
l=l+U|0;O=O-U|0}U=U+O|0;L=L+O|0;L>>>0<O>>>0&&(x=x+1|0);y[l|O]=128;if(56<=(O|0)){for(O=O+1|0;64>(O|0);O=O+1|0)y[l|O]=0;A(l);O=0;y[l|0]=0}for(O=O+1|0;59>(O|0);O=O+1|0)y[l|O]=0;y[l|56]=x>>>21&255;y[l|57]=x>>>13&255;y[l|58]=x>>>5&255;y[l|59]=x<<3&255|L>>>29;y[l|60]=L>>>21&255;y[l|61]=L>>>13&255;y[l|62]=L>>>5&255;y[l|63]=L<<3&255;A(l);~S&&M(S);return U|0}function h(){C=N;t=ma;K=Z;J=na;H=da;Q=ia;w=oa;F=qa;L=64;x=0}function B(){C=pa;t=ta;K=ra;J=ua;H=c;Q=p;w=I;F=z;L=64;x=0}function e(l,O,S){l|=0;S|=0;if(l&
63||~S&&S&31)return-1;var U=u(l,O|0,-1)|0;l=C;O=t;var Y=K;var W=J;var T=H;var aa=Q;var ba=w;var ca=F;B();n(l,O,Y,W,T,aa,ba,ca,2147483648,0,0,0,0,0,0,768);~S&&M(S);return U|0}"use asm";var C=0,t=0,K=0,J=0,H=0,Q=0,w=0,F=0,L=0,x=0,N=0,ma=0,Z=0,na=0,da=0,ia=0,oa=0,qa=0,pa=0,ta=0,ra=0,ua=0,c=0,p=0,I=0,z=0,y=new m.Uint8Array(k);return{reset:P,init:function(l,O,S,U,Y,W,T,aa,ba,ca){C=l|0;t=O|0;K=S|0;J=U|0;H=Y|0;Q=W|0;w=T|0;F=aa|0;L=ba|0;x=ca|0},process:v,finish:u,hmac_reset:h,hmac_init:function(l,O,S,U,Y,
W,T,aa,ba,ca,ea,fa,ha,ja,ka,la){l|=0;O|=0;S|=0;U|=0;Y|=0;W|=0;T|=0;aa|=0;ba|=0;ca|=0;ea|=0;fa|=0;ha|=0;ja|=0;ka|=0;la|=0;P();n(l^1549556828,O^1549556828,S^1549556828,U^1549556828,Y^1549556828,W^1549556828,T^1549556828,aa^1549556828,ba^1549556828,ca^1549556828,ea^1549556828,fa^1549556828,ha^1549556828,ja^1549556828,ka^1549556828,la^1549556828);pa=C;ta=t;ra=K;ua=J;c=H;p=Q;I=w;z=F;P();n(l^909522486,O^909522486,S^909522486,U^909522486,Y^909522486,W^909522486,T^909522486,aa^909522486,ba^909522486,ca^909522486,
ea^909522486,fa^909522486,ha^909522486,ja^909522486,ka^909522486,la^909522486);N=C;ma=t;Z=K;na=J;da=H;ia=Q;oa=w;qa=F;L=64;x=0},hmac_finish:e,pbkdf2_generate_block:function(l,O,S,U,Y){l|=0;O|=0;S|=0;U|=0;Y|=0;var W,T,aa,ba,ca,ea,fa,ha;if(l&63||~Y&&Y&31)return-1;y[l+O|0]=S>>>24;y[l+O+1|0]=S>>>16&255;y[l+O+2|0]=S>>>8&255;y[l+O+3|0]=S&255;e(l,O+4|0,-1)|0;l=W=C;O=T=t;S=aa=K;var ja=ba=J;var ka=ca=H;var la=ea=Q;var D=fa=w;var a=ha=F;for(U=U-1|0;0<(U|0);)h(),n(W,T,aa,ba,ca,ea,fa,ha,2147483648,0,0,0,0,0,0,
768),W=C,T=t,aa=K,ba=J,ca=H,ea=Q,fa=w,ha=F,B(),n(W,T,aa,ba,ca,ea,fa,ha,2147483648,0,0,0,0,0,0,768),W=C,T=t,aa=K,ba=J,ca=H,ea=Q,fa=w,ha=F,l^=C,O^=t,S^=K,ja^=J,ka^=H,la^=Q,D^=w,a^=F,U=U-1|0;C=l;t=O;K=S;J=ja;H=ka;Q=la;w=D;F=a;~Y&&M(Y);return 0}}}},"transform/TextTransformer.js":function(R,X,V){var m=V("../Operation"),G=V("../Common"),k=function(n,A){if(n.offset>A.offset){if(n.offset>A.offset+A.toRemove)return m.create(n.offset-A.toRemove+A.toInsert.length,n.toRemove,n.toInsert);var M=n.toRemove-(A.offset+
A.toRemove-n.offset);0>M&&(M=0);return 0===M&&0===n.toInsert.length?null:m.create(A.offset+A.toInsert.length,M,n.toInsert)}if(n.offset+n.toRemove<A.offset)return n;A=A.offset-n.offset;return 0===A&&0===n.toInsert.length?null:m.create(n.offset,A,n.toInsert)};R.exports=function(n,A,M){var P;for(P=A.length-1;0<=P;P--)M=m.apply(A[P],M);var v=[];for(P=n.length-1;0<=P;P--){for(var u=n[P],h=A.length-1;0<=h;h--){try{var B=u,e=A[h];G.PARANOIA&&(m.check(B),m.check(e));var C=k(B,e);G.PARANOIA&&C&&m.check(C);
u=C}catch(t){return console.error("The pluggable transform function threw an error, failing operational transformation"),console.error(t.stack),[]}if(!u)break}u&&(G.PARANOIA&&m.check(u,M.length),v.unshift(u))}return v}},"transform/NaiveJSONTransformer.js":function(R,X,V){var m=V("./TextTransformer"),G=V("../Operation"),k=V("../Common");R.exports=function(n,A,M){var P=k.global.REALTIME_DEBUG=k.global.REALTIME_DEBUG||{};try{var v=m(n,A,M);var u=G.applyMulti(A,M);var h=G.applyMulti(v,u);try{return JSON.parse(h),
v}catch(B){console.error(B),P.ot_parseError={type:"resultParseError",resultOps:v,toTransform:n,transformBy:A,text1:M,text2:u,text3:h,error:B},console.log("Debugging info available at `window.REALTIME_DEBUG.ot_parseError`")}}catch(B){console.error(B),P.ot_applyError={type:"resultParseError",resultOps:v,toTransform:n,transformBy:A,text1:M,text2:u,text3:h,error:B},console.log("Debugging info available at `window.REALTIME_DEBUG.ot_applyError`")}return[]}},"transform/SmartJSONTransformer.js":function(R,
X,V){var m=V("json.sortify"),G=V("../Diff"),k=V("../Operation"),n=V("./TextTransformer"),A=function(w){return null===w?"null":"[object Array]"===Object.prototype.toString.call(w)?"array":typeof w},M=function(w,F){for(var L=F.length,x=0;x<L;x++){if("undefined"===typeof w[F[x]])return;w=w[F[x]]}return w},P=function(w,F){var L=A(w),x=A(F);return L!==x?!1:"object"===L?(L=Object.keys(w),x=Object.keys(F),L.length===x.length&&!L.some(function(N){return!P(w[N],F[N])})&&!x.some(function(N){return!(N in w)})):
"array"===L?w.length===F.length&&!w.some(function(N,ma){return!P(N,F[ma])}):w===F},v=function(w,F,L,x,N){if("replace"===w)return{type:"replace",path:F,value:L,prev:x};if("splice"===w){if("number"!==typeof x)throw Error();if("number"!==typeof N)throw Error();return{type:"splice",path:F,value:L,offset:x,removals:N}}if("remove"!==w)throw Error("expected a removal");return{type:"remove",path:F,value:L}},u=function(w,F,L,x){w.push(v("replace",F,L,x))},h=function(w,F){return!w.some(function(L,x){return L!==
F[x]})},B=function(){var w=["replace","remove","splice"],F={},L=1;w.forEach(function(x){F[x]={};return w.forEach(function(N){F[x][N]=L++})});return F}(),e=function(w,F,L){if("array"!==A(w)||"array"!==A(F))throw Error("[resolve] expected two arrays");return F=F.filter(function(x){if(w.some(function(N){if("remove"===N.type&&h(N.path,x.path)&&1<x.path.length-N.path.length)return!0})||"splice"===x.type&&w.some(function(N){if("splice"===N.type&&h(N.path,x.path)&&0>N.path.length-x.path.length&&N.removals)for(var ma=
N.offset,Z=N.offset+N.removals;ma<Z;ma++)if(ma===x.path[N.path.length])return!0}))return!1;if(!w.some(function(N){return"remove"===x.type&&P(N.path,x.path)}))return!0}).filter(function(x){return!w.some(function(N){if("replace"===x.type&&"replace"===N.type&&P(N.path,x.path))return"string"===typeof N.value&&"string"===typeof x.value&&L&&N.prev===x.prev&&N.value!==x.value?L(N,x,B.replace.replace):!0})}).map(function(x){w.forEach(function(N){if("splice"===N.type)if(P(N.path,x.path))"splice"===x.type&&
(x.offset>N.offset+x.removals?x.offset+=N.value.length-N.removals:x.offset<N.offset?x.removals=Math.max(N.offset-x.offset,0):(x.removals=Math.max(x.removals-(x.offset+N.removals-x.offset),0),x.offset+=N.value.length-N.removals));else if(h(N.path,x.path)){var ma=N.path.length;"number"===typeof x.path[ma]&&N.offset<=x.path[ma]&&(x.path[ma]+=N.value.length-N.removals)}});return x})},C=function(w,F,L,x){var N=Object.keys(w),ma=Object.keys(F);ma.forEach(function(Z){var na=A(F[Z]),da=w[Z],ia=L.concat(Z);
if(-1===N.indexOf(Z)){if("undefined"===na)throw Error("undefined type has key. this shouldn't happen?");if(da)throw Error("no such key existed in b, so 'old' should be falsey");u(x,ia,F[Z],da)}else{var oa=A(da);if(oa!==na){console.log("type changed from [%s] to [%s]",oa,na);if("undefined"===na)throw Error("first pass should never reveal undefined keys");u(x,ia,F[Z],da)}else"object"===oa?C(w[Z],F[Z],ia,x):"array"===oa?K(w[Z],F[Z],ia,x):w[Z]!==F[Z]&&u(x,ia,F[Z],da)}});N.forEach(function(Z){if(-1===
ma.indexOf(Z)||"undefined"===A(F[Z])){var na=L.concat(Z);x.push(v("remove",na,w[Z]))}})},t=function(w,F){if(w.length!==F.length)return!1;for(var L=0;L<w.length;L++)if(A(w[L])!==A(F[L]))return!1;return!0},K=function(w,F,L,x){var N=w.slice(0);if(0===N.length)x.push(v("splice",L,F,0,0));else if(t(N,F))N.forEach(function(na,da){var ia=F[da];if(ia!==na)switch(da=L.concat(da),A(na)){case "undefined":throw Error("existing key had type `undefined`. this should never happen");case "object":C(na,ia,da,x);break;
case "array":K(na,ia,da,x);break;default:u(x,da,ia,na)}});else{for(var ma=w=0;w<N.length&&P(N[w],F[w]);)w++;for(;P(N[N.length-1-ma],F[F.length-1-ma])&&ma+w<N.length&&ma+w<F.length;)ma++;N=N.length-w-ma;var Z=[];F.length!==w+ma&&(Z=F.slice(w,F.length-ma));x.push(v("splice",L,Z,w,N))}},J=function(w,F){var L=[],x=A(w),N=A(F);if(x!==N)throw Error("Can't merge two objects of differing types");if("array"===N)K(w,F,[],L);else if("object"===N)C(w,F,[],L);else throw Error("unsupported datatype"+N);return L},
H=function(w,F){F.forEach(function(L){switch(L.type){case "replace":var x=L.path[L.path.length-1];var N=L.path.slice(0,L.path.length-1);N=M(w,N);if(!N)throw Error("cannot apply change to non-existent element");N[x]=L.value;break;case "splice":x=M(w,L.path);if(!x)throw console.error("[applyOp] expected path [%s] to exist in object",L.path.join(",")),Error("Path did not exist");if("array"!==A(x))throw Error("Can't splice non-array");Array.prototype.splice.apply(x,[L.offset,L.removals].concat(L.value));
break;case "remove":x=L.path[L.path.length-1];N=L.path.slice(0,L.path.length-1);L=M(w,N);"undefined"!==typeof L&&delete L[x];break;default:throw Error("unsupported operation type");}});return w},Q=function(w,F,L){if(w.prev!==F.prev)throw Error("Parent values don't match!");if(L===B.splice.splice)return console.log(w),console.log(F),console.log("\n\n\n\n\n\n\n\n\n"),!0;L=w.prev;w=G.diff(L,w.value);var x=G.diff(L,F.value);x=n(x,w,L);L=k.applyMulti(w,L);L=k.applyMulti(x,L);F.value=L};R.exports=function(w,
F,L){var x=JSON.parse(L);F=k.applyMulti(F,L);var N=JSON.parse(F);w=k.applyMulti(w,L);w=JSON.parse(w);try{var ma=J(x,w),Z=J(x,N),na=e(Z,ma,Q);H(x,Z);H(x,na);var da=m(x);return G.diff(F,da)}catch(ia){console.error(ia)}return[]};R.exports._={clone:function(w){return JSON.parse(JSON.stringify(w))},pathOverlaps:h,deepEqual:P,diff:J,resolve:e,patch:H,arbiter:Q}}};sa.m[1]={"dist/JSON.sortify.js":function(R,X,V){(function(m){"undefined"!==typeof R&&R.exports?R.exports=m():"function"==typeof define&&"object"==
typeof define.amd?define("json.sortify",m):JSON.sortify=m()})(function(){var m=function A(n){if(Array.isArray(n))return n.map(A);if(n instanceof Object){var M=function(){var P=[],v=[];Object.keys(n).forEach(function(u){/^(0|[1-9][0-9]*)$/.test(u)?P.push(+u):v.push(u)});return{v:P.sort(function(u,h){return u-h}).concat(v.sort()).reduce(function(u,h){u[h]=A(n[h]);return u},{})}}();if("object"===typeof M)return M.v}return n},G=JSON.stringify.bind(JSON);return function(n,A,M){n=G(n,A,0);if(!n||"{"!==
n[0]&&"["!==n[0])return n;n=JSON.parse(n);return G(m(n),null,M)}})}};sa.m[2]={"diff.js":function(R,X,V){function m(e,C,t,K){if(e===C)return e?[[0,e]]:[];if(null!=t){a:{var J=e;var H=C;var Q="number"===typeof t?{index:t,length:0}:t.oldRange,w="number"===typeof t?null:t.newRange,F=J.length,L=H.length;if(0===Q.length&&(null===w||0===w.length)){var x=Q.index;t=J.slice(0,x);var N=J.slice(x),ma=w?w.index:null;var Z=x+L-F;if(!(null!==ma&&ma!==Z||0>Z||Z>L)){var na=H.slice(0,Z),da=H.slice(Z);if(da===N){Z=
Math.min(x,Z);da=t.slice(0,Z);var ia=na.slice(0,Z);if(da===ia){J=t.slice(Z);H=na.slice(Z);H=h(da,J,H,N);break a}}}if(null===ma||ma===x)if(na=H.slice(0,x),da=H.slice(x),na===t&&(x=Math.min(F-x,L-x),na=N.slice(N.length-x),ma=da.slice(da.length-x),na===ma)){J=N.slice(0,N.length-x);H=da.slice(0,da.length-x);H=h(t,J,H,na);break a}}if(0<Q.length&&w&&0===w.length&&(da=J.slice(0,Q.index),na=J.slice(Q.index+Q.length),Z=da.length,x=na.length,!(L<Z+x)&&(ia=H.slice(0,Z),ma=H.slice(L-x),da===ia&&na===ma))){J=
J.slice(Z,F-x);H=H.slice(Z,L-x);H=h(da,J,H,na);break a}H=null}if(H)return H}N=n(e,C);H=e.substring(0,N);e=e.substring(N);C=C.substring(N);N=A(e,C);t=e.substring(e.length-N);e=e.substring(0,e.length-N);C=C.substring(0,C.length-N);e=G(e,C);H&&e.unshift([0,H]);t&&e.push([0,t]);P(e,K);return e}function G(e,C){if(!e)return[[1,C]];if(!C)return[[-1,e]];var t=e.length>C.length?e:C;var K=e.length>C.length?C:e,J=t.indexOf(K);if(-1!==J)return t=[[1,t.substring(0,J)],[0,K],[1,t.substring(J+K.length)]],e.length>
C.length&&(t[0][0]=t[2][0]=-1),t;if(1===K.length)return[[-1,e],[1,C]];if(t=M(e,C))return C=t[1],K=t[3],e=t[4],t=m(t[0],t[2]),C=m(C,K),t.concat([[0,e]],C);a:{t=e.length;K=C.length;J=Math.ceil((t+K)/2);for(var H=2*J,Q=Array(H),w=Array(H),F=0;F<H;F++)Q[F]=-1,w[F]=-1;Q[J+1]=0;w[J+1]=0;F=t-K;for(var L=0!==F%2,x=0,N=0,ma=0,Z=0,na=0;na<J;na++){for(var da=-na+x;da<=na-N;da+=2){var ia=J+da;var oa=da===-na||da!==na&&Q[ia-1]<Q[ia+1]?Q[ia+1]:Q[ia-1]+1;for(var qa=oa-da;oa<t&&qa<K&&e.charAt(oa)===C.charAt(qa);)oa++,
qa++;Q[ia]=oa;if(oa>t)N+=2;else if(qa>K)x+=2;else if(L&&(ia=J+F-da,0<=ia&&ia<H&&-1!==w[ia])){var pa=t-w[ia];if(oa>=pa){e=k(e,C,oa,qa);break a}}}for(da=-na+ma;da<=na-Z;da+=2){ia=J+da;pa=da===-na||da!==na&&w[ia-1]<w[ia+1]?w[ia+1]:w[ia-1]+1;for(oa=pa-da;pa<t&&oa<K&&e.charAt(t-pa-1)===C.charAt(K-oa-1);)pa++,oa++;w[ia]=pa;if(pa>t)Z+=2;else if(oa>K)ma+=2;else if(!L&&(ia=J+F-da,0<=ia&&ia<H&&-1!==Q[ia]&&(oa=Q[ia],qa=J+oa-ia,pa=t-pa,oa>=pa))){e=k(e,C,oa,qa);break a}}}e=[[-1,e],[1,C]]}return e}function k(e,
C,t,K){var J=e.substring(0,t),H=C.substring(0,K);e=e.substring(t);C=C.substring(K);J=m(J,H);H=m(e,C);return J.concat(H)}function n(e,C){if(!e||!C||e.charAt(0)!==C.charAt(0))return 0;for(var t=0,K=Math.min(e.length,C.length),J=K,H=0;t<J;)e.substring(H,J)==C.substring(H,J)?H=t=J:K=J,J=Math.floor((K-t)/2+t);v(e.charCodeAt(J-1))&&J--;return J}function A(e,C){if(!e||!C||e.slice(-1)!==C.slice(-1))return 0;for(var t=0,K=Math.min(e.length,C.length),J=K,H=0;t<J;)e.substring(e.length-J,e.length-H)==C.substring(C.length-
J,C.length-H)?H=t=J:K=J,J=Math.floor((K-t)/2+t);u(e.charCodeAt(e.length-J))&&J--;return J}function M(e,C){function t(Q,w,F){for(var L=Q.substring(F,F+Math.floor(Q.length/4)),x=-1,N="",ma,Z,na,da;-1!==(x=w.indexOf(L,x+1));){var ia=n(Q.substring(F),w.substring(x)),oa=A(Q.substring(0,F),w.substring(0,x));N.length<oa+ia&&(N=w.substring(x-oa,x)+w.substring(x,x+ia),ma=Q.substring(0,F-oa),Z=Q.substring(F+ia),na=w.substring(0,x-oa),da=w.substring(x+ia))}return 2*N.length>=Q.length?[ma,Z,na,da,N]:null}var K=
e.length>C.length?e:C,J=e.length>C.length?C:e;if(4>K.length||2*J.length<K.length)return null;var H=t(K,J,Math.ceil(K.length/4));K=t(K,J,Math.ceil(K.length/2));if(H||K)H=K?H?H[4].length>K[4].length?H:K:K:H;else return null;e.length>C.length?(e=H[0],C=H[1],K=H[2],J=H[3]):(K=H[0],J=H[1],e=H[2],C=H[3]);return[e,C,K,J,H[4]]}function P(e,C){e.push([0,""]);for(var t=0,K=0,J=0,H="",Q="",w;t<e.length;)if(t<e.length-1&&!e[t][1])e.splice(t,1);else switch(e[t][0]){case 1:J++;Q+=e[t][1];t++;break;case -1:K++;
H+=e[t][1];t++;break;case 0:var F=t-J-K-1;if(C){if(w=0<=F)w=e[F][1],w=v(w.charCodeAt(w.length-1));w&&(w=e[F][1].slice(-1),e[F][1]=e[F][1].slice(0,-1),H=w+H,Q=w+Q,e[F][1]||(e.splice(F,1),t--,--F,e[F]&&1===e[F][0]&&(J++,Q=e[F][1]+Q,F--),e[F]&&-1===e[F][0]&&(K++,H=e[F][1]+H,F--)));u(e[t][1].charCodeAt(0))&&(w=e[t][1].charAt(0),e[t][1]=e[t][1].slice(1),H+=w,Q+=w)}if(t<e.length-1&&!e[t][1])e.splice(t,1);else{if(0<H.length||0<Q.length)0<H.length&&0<Q.length&&(w=n(Q,H),0!==w&&(0<=F?e[F][1]+=Q.substring(0,
w):(e.splice(0,0,[0,Q.substring(0,w)]),t++),Q=Q.substring(w),H=H.substring(w)),w=A(Q,H),0!==w&&(e[t][1]=Q.substring(Q.length-w)+e[t][1],Q=Q.substring(0,Q.length-w),H=H.substring(0,H.length-w))),K=J+K,0===H.length&&0===Q.length?(e.splice(t-K,K),t-=K):0===H.length?(e.splice(t-K,K,[1,Q]),t=t-K+1):0===Q.length?(e.splice(t-K,K,[-1,H]),t=t-K+1):(e.splice(t-K,K,[-1,H],[1,Q]),t=t-K+2);0!==t&&0===e[t-1][0]?(e[t-1][1]+=e[t][1],e.splice(t,1)):t++;K=J=0;Q=H=""}}""===e[e.length-1][1]&&e.pop();H=!1;for(t=1;t<e.length-
1;)0===e[t-1][0]&&0===e[t+1][0]&&(e[t][1].substring(e[t][1].length-e[t-1][1].length)===e[t-1][1]?(e[t][1]=e[t-1][1]+e[t][1].substring(0,e[t][1].length-e[t-1][1].length),e[t+1][1]=e[t-1][1]+e[t+1][1],e.splice(t-1,1),H=!0):e[t][1].substring(0,e[t+1][1].length)==e[t+1][1]&&(e[t-1][1]+=e[t+1][1],e[t][1]=e[t][1].substring(e[t+1][1].length)+e[t+1][1],e.splice(t+1,1),H=!0)),t++;H&&P(e,C)}function v(e){return 55296<=e&&56319>=e}function u(e){return 56320<=e&&57343>=e}function h(e,C,t,K){if(v(e.charCodeAt(e.length-
1))||u(K.charCodeAt(0)))return null;e=[[0,e],[-1,C],[1,t],[0,K]];C=[];for(t=0;t<e.length;t++)0<e[t][1].length&&C.push(e[t]);return C}function B(e,C,t){return m(e,C,t,!0)}B.INSERT=1;B.DELETE=-1;B.EQUAL=0;R.exports=B}};(function(R,X){"object"==typeof exports&&(module.exports=R);"function"==typeof define&&define.amd&&define("chainpad",function(){return R});var V;"undefined"!=typeof window?V=window:"undefined"!=typeof global?V=global:"undefined"!=typeof self&&(V=self);V[X]=R})(sa("ChainPad.js"),"ChainPad")})();

//# sourceMappingURL=chainpad.dist.min.js.map
